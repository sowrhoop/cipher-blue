(typeattribute userns_privileged_file_type)
(typeattributeset userns_privileged_file_type (colord_exec_t container_runtime_exec_t devicekit_power_exec_t docker_exec_t file_manager_exec_type flatpak_exec_t kubelet_exec_t systemsettings_exec_t trivalent_exec_t trivalent_script_exec_t))

(typeattribute userns_relabel_allowed)
(typeattributeset userns_relabel_allowed (init_t initrc_t install_t kernel_t))

(typeattribute userns_relabel_restricted)
(typeattributeset userns_relabel_restricted (and (domain) (not (userns_relabel_allowed))))

(deny userns_relabel_restricted userns_privileged_file_type (blk_file (relabelfrom relabelto)))
(deny userns_relabel_restricted userns_privileged_file_type (chr_file (relabelfrom relabelto)))
(deny userns_relabel_restricted userns_privileged_file_type (dir (relabelfrom relabelto)))
(deny userns_relabel_restricted userns_privileged_file_type (fifo_file (relabelfrom relabelto)))
(deny userns_relabel_restricted userns_privileged_file_type (file (relabelfrom relabelto)))
(deny userns_relabel_restricted userns_privileged_file_type (lnk_file (relabelfrom relabelto)))
